## 1. Создайте деплоймент `app` на базе образа nginx:1.17 и сервис на порт 80

Можно использовать команду `kubectl run` с ключами `--expose` и `--port`
Документация: https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#run

## 2. Создайте ingress для hostname `my.s<номер_студента>.k8s.slurm.io` и направьте его на сервис, созданный вами в первом шаге.

Пример манифеста: https://kubernetes.io/docs/concepts/services-networking/ingress/#single-service-ingress

Сделайте несколько curl запросов к вашему приложению, и убедитесь что видите ответ от nginx.

## 3. Создайте конфиг мап из файла `default.conf` с конфигурацией nginx.

Можно воспользоваться командой `kubectl create configmap` с ключом `--from-file`

## 4. Добавьте в деплоймент монтирование созданного configmap как файл в каталог `/etc/nginx/conf.d`

# Документация к самостоятельному изучению

https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/

Сделайте несколько curl запросов к вашему приложению, и убедитесь что видите в ответе название пода и ваш запрос.

## 5. Создайте секрет c ключом password

Можно использовать команду `kubectl create secret generic` с ключом `--from-literal`

Документация: https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#-em-secret-generic-em-

## 6. Создайте configmap из файла default-secret.conf

## 7. Создайте копию деплоймента `app`

Можно использовать команду `kubectl get deploy app -o yaml --export >appsecret.yaml`

## 8. Отредактируйте манифест в файле appsecret.yaml

Необходимо изменить:
  - название деплоймента
  - все метки в полях `label:`
  - монтирование configmap с файлом `default-secret.yaml`

Добавьте монтирование секрета как файл в каталог `/opt`

## 9. Примените манифест в кластер и убедитесь что второе приложение запустилось.

## 10. Повторите действия с копированием сервиса, не забудьте исправить метки в поле `selector` сервиса

После применения манифеста с сервисом убедитесь, что сервис видит приложение. Сделать это можно с помощью команд

```
kubectl get pod -o wide
kubectl get ep
```

ip адреса подов приложения должны совпадать с ip адресами Endpoints в сервисе.

## 11. Отредактируйте ingress, чтобы он теперь указывал на новый сервис.

Отредактировать налету можно командой `kubectl edit ing <название ингресса>`

проверьте, что по запросу url `/secret/password` отдается содержимое секрета, а по `/` отдается название пода и значение запроса.

## 12. Добавьте path и второй хост в ingress, таким образом, чтобы:

Запросы на url /app отправлялись в поды app
Запросы на url /sec отправлялись в под app-secret

Документация: https://kubernetes.io/docs/concepts/services-networking/ingress/#simple-fanout

Проверьте с помощью curl.
Попробуйте разобраться почему запросы на url `/sec/secret/password` попадают на второй деплоймент, но значение секрета не возвращают.
При этом запросы на `/secret/password` почему-то возвращают значение секрета.

## 13.* Задача со звездочкой.

Измените конфигурацию ингрессов таким образом, чтобы запросы на `/app` отправлялись в поды `app`, на `/sec` в поды `appsecret`,
но в то же время по запросу `/app/secret/password` отдавалось содержимое секрета.

## 14.** Задача с двумя звездочками.

Сгенерируйте самоподписанный сертификат
создайте из ключа и сертификата секрет типа tls
пропишите в ingress секцию tls и проверьте доступ к вашему сервису по https
Проверка считается успешной, если команда 
`curl -k -v https://s<номерстудента>.k8s.slurm.io` показывает, что сервер предъявил ваш сампоподписанный сертификат.

